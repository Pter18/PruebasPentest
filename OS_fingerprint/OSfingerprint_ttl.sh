#!/bin/bash
: <<'end_long_comment'
Plan de becarios generacion 13
Curso: Pruebas de penetracion
Alumno: Rodriguez Gallardo Pedro Alejandro


Programa que escanea una red y determina en base al TTL que tipo de
Sistema operativo es.
end_long_comment

ip_UP()
{
  ttl=$(ping -c 1 $1 | awk '/ttl=/ {print $6}' | cut -d"=" -f2)
  if [[ $ttl -ne null ]]; then
    if [[ $ttl -eq 64 ]]; then
      echo IP: $1 es un Sistema tipo: Linux
    elif [ $ttl -gt 127 ]; then
      echo IP: $1 es un Sistema tipo: Windows
    else
      echo IP: $1 tiene un TTL=$ttl
    fi
  fi
}

for i in 192.168.15.{1..255}; do
  ip_UP $i & disown
done
